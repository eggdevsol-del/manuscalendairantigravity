<mxfile host="app.diagrams.net" modified="2026-02-08T06:57:23.000Z" agent="Antigravity" version="24.0.0" etag="patent-fig2-v1">
  <diagram name="FIG. 2 - Slot Finding Subprocess" id="fig2-slot-finding">
    <mxGraphModel dx="1422" dy="794" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="1400" pageHeight="1800" math="0" shadow="0">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />
        
        <!-- Title -->
        <mxCell id="title" value="FIG. 2: TIMEZONE-AWARE SLOT FINDING ALGORITHM&#xa;WITH GREEDY FIRST-FIT STRATEGY" style="text;html=1;strokeColor=#666666;fillColor=#f5f5f5;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=16;fontStyle=1;strokeWidth=2" vertex="1" parent="1">
          <mxGeometry x="200" y="20" width="1000" height="60" as="geometry" />
        </mxCell>
        
        <!-- START (400) -->
        <mxCell id="400" value="400&#xa;START findNextAvailableSlot&#xa;INPUT: searchPointer, duration,&#xa;schedule, conflicts, timezone" style="ellipse;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;fontSize=11;fontStyle=1" vertex="1" parent="1">
          <mxGeometry x="600" y="120" width="200" height="90" as="geometry" />
        </mxCell>
        
        <!-- Initialize (410) -->
        <mxCell id="410" value="410&#xa;INITIALIZE SEARCH PARAMETERS:&#xa;• currentPointer = searchPointer&#xa;• Align to 30-min boundary:&#xa;  remainder = minutes MOD 30&#xa;  IF remainder ≠ 0 THEN&#xa;    minutes += (30 - remainder)&#xa;• endSearchLimit = searchPointer + 365 days&#xa;• iterationCount = 0" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=10" vertex="1" parent="1">
          <mxGeometry x="520" y="250" width="360" height="130" as="geometry" />
        </mxCell>
        
        <mxCell id="edge400_410" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="1" source="400" target="410">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        
        <!-- While Loop (420) -->
        <mxCell id="420" value="420&#xa;currentPointer&#xa;&lt;&#xa;endSearchLimit?" style="rhombus;whiteSpace=wrap;html=1;fillColor=#ffe6cc;strokeColor=#d79b00;fontSize=11" vertex="1" parent="1">
          <mxGeometry x="600" y="420" width="200" height="100" as="geometry" />
        </mxCell>
        
        <mxCell id="edge410_420" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="1" source="410" target="420">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        
        <!-- Extract Day Name (430) -->
        <mxCell id="430" value="430&#xa;TIMEZONE-AWARE DAY EXTRACTION:&#xa;dayName = Intl.DateTimeFormat(&#xa;  'en-US',&#xa;  { weekday: 'long', timeZone: timezone }&#xa;).format(currentPointer)&#xa;(See FIG. 4 for timezone handling details)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#e1d5e7;strokeColor=#9673a6;align=left;fontSize=10" vertex="1" parent="1">
          <mxGeometry x="520" y="560" width="360" height="100" as="geometry" />
        </mxCell>
        
        <mxCell id="edge420_430" value="YES" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontStyle=1;fontSize=11" edge="1" parent="1" source="420" target="430">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        
        <!-- Novel Feature Box -->
        <mxCell id="novel1" value="NOVEL FEATURE:&#xa;Timezone-aware day&#xa;extraction ensures&#xa;correct scheduling&#xa;across DST boundaries&#xa;and international&#xa;time zones" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fff4e6;strokeColor=#ff9800;fontSize=9;fontStyle=2;dashed=1;dashPattern=5 5" vertex="1" parent="1">
          <mxGeometry x="940" y="575" width="160" height="100" as="geometry" />
        </mxCell>
        
        <mxCell id="edge_novel1" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;dashed=1;strokeColor=#ff9800;" edge="1" parent="1" source="novel1" target="430">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        
        <!-- Find Schedule (440) -->
        <mxCell id="440" value="440&#xa;Lookup work schedule for day:&#xa;scheduleEntry = schedule.find(&#xa;  entry => entry.day.toLowerCase()&#xa;    === dayName.toLowerCase()&#xa;)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#e1d5e7;strokeColor=#9673a6;align=left;fontSize=10" vertex="1" parent="1">
          <mxGeometry x="540" y="700" width="320" height="80" as="geometry" />
        </mxCell>
        
        <mxCell id="edge430_440" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="1" source="430" target="440">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        
        <!-- Check Day Enabled (450) -->
        <mxCell id="450" value="450&#xa;scheduleEntry&#xa;exists AND&#xa;enabled = true?" style="rhombus;whiteSpace=wrap;html=1;fillColor=#ffe6cc;strokeColor=#d79b00;fontSize=10" vertex="1" parent="1">
          <mxGeometry x="610" y="820" width="180" height="100" as="geometry" />
        </mxCell>
        
        <mxCell id="edge440_450" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="1" source="440" target="450">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        
        <!-- Parse Times (460) -->
        <mxCell id="460" value="460&#xa;PARSE TIME STRINGS:&#xa;startTime = parseTime(&#xa;  scheduleEntry.start || scheduleEntry.startTime&#xa;)&#xa;endTime = parseTime(&#xa;  scheduleEntry.end || scheduleEntry.endTime&#xa;)&#xa;// Handles AM/PM, 12/24-hour formats&#xa;// Returns {hour: int, minute: int}" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#e1d5e7;strokeColor=#9673a6;align=left;fontSize=9" vertex="1" parent="1">
          <mxGeometry x="380" y="830" width="180" height="150" as="geometry" />
        </mxCell>
        
        <mxCell id="edge450_460" value="YES" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontStyle=1;fontSize=10" edge="1" parent="1" source="450" target="460">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        
        <!-- Calculate Current Time in TZ (470) -->
        <mxCell id="470" value="470&#xa;EXTRACT CURRENT TIME IN TIMEZONE:&#xa;timeParts = Intl.DateTimeFormat('en-US', {&#xa;  timeZone: timezone,&#xa;  hour: 'numeric',&#xa;  minute: 'numeric',&#xa;  hour12: false&#xa;}).formatToParts(currentPointer)&#xa;&#xa;currentHour = parseInt(timeParts.hour)&#xa;currentMinute = parseInt(timeParts.minute)&#xa;currentTotalMinutes = currentHour × 60 + currentMinute" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#e1d5e7;strokeColor=#9673a6;align=left;fontSize=8" vertex="1" parent="1">
          <mxGeometry x="340" y="1020" width="260" height="160" as="geometry" />
        </mxCell>
        
        <mxCell id="edge460_470" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="1" source="460" target="470">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        
        <!-- Calculate Work Window (480) -->
        <mxCell id="480" value="480&#xa;CALCULATE WORK WINDOW:&#xa;startTotalMinutes = startTime.hour × 60&#xa;  + startTime.minute&#xa;endTotalMinutes = endTime.hour × 60&#xa;  + endTime.minute&#xa;&#xa;// Handle overnight shifts&#xa;IF endTotalMinutes &lt; startTotalMinutes THEN&#xa;  endTotalMinutes += 24 × 60" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#e1d5e7;strokeColor=#9673a6;align=left;fontSize=9" vertex="1" parent="1">
          <mxGeometry x="340" y="1220" width="260" height="140" as="geometry" />
        </mxCell>
        
        <mxCell id="edge470_480" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="1" source="470" target="480">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        
        <!-- Check Within Hours (490) -->
        <mxCell id="490" value="490&#xa;currentTotalMinutes&#xa;≥&#xa;startTotalMinutes?" style="rhombus;whiteSpace=wrap;html=1;fillColor=#ffe6cc;strokeColor=#d79b00;fontSize=10" vertex="1" parent="1">
          <mxGeometry x="380" y="1400" width="180" height="90" as="geometry" />
        </mxCell>
        
        <mxCell id="edge480_490" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="1" source="480" target="490">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        
        <!-- Check Slot Fits (500) -->
        <mxCell id="500" value="500&#xa;(currentTotalMinutes&#xa;+ duration)&#xa;≤&#xa;endTotalMinutes?" style="rhombus;whiteSpace=wrap;html=1;fillColor=#ffe6cc;strokeColor=#d79b00;fontSize=10" vertex="1" parent="1">
          <mxGeometry x="180" y="1400" width="160" height="90" as="geometry" />
        </mxCell>
        
        <mxCell id="edge490_500" value="YES" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontStyle=1;fontSize=10" edge="1" parent="1" source="490" target="500">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        
        <!-- Collision Detection (510) -->
        <mxCell id="510" value="510&#xa;COLLISION DETECTION:&#xa;potentialEnd = currentPointer&#xa;  + (duration × 60000)&#xa;&#xa;hasCollision = conflicts.some(appt =>&#xa;  currentPointer &lt; appt.endTime AND&#xa;  potentialEnd > appt.startTime&#xa;)&#xa;(See FIG. 3 for detailed algorithm)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#e1d5e7;strokeColor=#9673a6;align=left;fontSize=9" vertex="1" parent="1">
          <mxGeometry x="150" y="1530" width="220" height="140" as="geometry" />
        </mxCell>
        
        <mxCell id="edge500_510" value="YES" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontStyle=1;fontSize=10" edge="1" parent="1" source="500" target="510">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        
        <!-- Reference to FIG 3 -->
        <mxCell id="fig3_ref" value="See FIG. 3&#xa;Collision&#xa;Detection&#xa;Details" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#e3f2fd;strokeColor=#1976d2;fontSize=9;fontStyle=2;dashed=1" vertex="1" parent="1">
          <mxGeometry x="40" y="1560" width="80" height="80" as="geometry" />
        </mxCell>
        
        <mxCell id="edge_fig3" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;dashed=1;strokeColor=#1976d2;" edge="1" parent="1" source="fig3_ref" target="510">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        
        <!-- Has Collision Check (520) -->
        <mxCell id="520" value="520&#xa;hasCollision&#xa;= true?" style="rhombus;whiteSpace=wrap;html=1;fillColor=#ffe6cc;strokeColor=#d79b00;fontSize=10" vertex="1" parent="1">
          <mxGeometry x="190" y="1710" width="140" height="70" as="geometry" />
        </mxCell>
        
        <mxCell id="edge510_520" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="1" source="510" target="520">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        
        <!-- SUCCESS RETURN (530) -->
        <mxCell id="530" value="530&#xa;RETURN SUCCESS&#xa;currentPointer&#xa;(Valid slot found!)" style="ellipse;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;fontStyle=1;fontSize=11" vertex="1" parent="1">
          <mxGeometry x="410" y="1710" width="160" height="70" as="geometry" />
        </mxCell>
        
        <mxCell id="edge520_530" value="NO&#xa;(slot valid)" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontStyle=1;fontSize=9" edge="1" parent="1" source="520" target="530">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        
        <!-- Increment Pointer (540) -->
        <mxCell id="540" value="540&#xa;INCREMENT SEARCH POINTER:&#xa;currentPointer += 30 minutes&#xa;iterationCount++&#xa;&#xa;// 30-minute granularity provides&#xa;// optimal scheduling flexibility" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=9" vertex="1" parent="1">
          <mxGeometry x="920" y="1400" width="220" height="100" as="geometry" />
        </mxCell>
        
        <!-- All NO paths lead to increment -->
        <mxCell id="edge520_540" value="YES&#xa;(collision)" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontStyle=1;fontSize=9;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" edge="1" parent="1" source="520" target="540">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="260" y="1820" />
              <mxPoint x="860" y="1820" />
              <mxPoint x="860" y="1450" />
            </Array>
          </mxGeometry>
        </mxCell>
        
        <mxCell id="edge500_540" value="NO&#xa;(doesn't fit)" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontStyle=1;fontSize=9;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.75;entryDx=0;entryDy=0;" edge="1" parent="1" source="500" target="540">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="380" y="1445" />
              <mxPoint x="380" y="1550" />
              <mxPoint x="860" y="1550" />
              <mxPoint x="860" y="1475" />
            </Array>
          </mxGeometry>
        </mxCell>
        
        <mxCell id="edge490_540" value="NO&#xa;(too early)" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontStyle=1;fontSize=9;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.25;entryDx=0;entryDy=0;" edge="1" parent="1" source="490" target="540">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="640" y="1445" />
              <mxPoint x="640" y="1425" />
            </Array>
          </mxGeometry>
        </mxCell>
        
        <mxCell id="edge450_540" value="NO&#xa;(day disabled)" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontStyle=1;fontSize=9;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="450" target="540">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="1030" y="870" />
            </Array>
          </mxGeometry>
        </mxCell>
        
        <!-- Loop Back -->
        <mxCell id="edge540_420" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=0;exitDx=0;exitDy=0;entryX=1;entryY=0.5;entryDx=0;entryDy=0;strokeWidth=2;strokeColor=#d6b656" edge="1" parent="1" source="540" target="420">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="1030" y="470" />
            </Array>
          </mxGeometry>
        </mxCell>
        
        <mxCell id="loop_label" value="LOOP BACK&#xa;Continue search" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=9;fontStyle=2" vertex="1" parent="1">
          <mxGeometry x="1060" y="700" width="80" height="40" as="geometry" />
        </mxCell>
        
        <!-- FAILURE RETURN (550) -->
        <mxCell id="550" value="550&#xa;RETURN FAILURE&#xa;null&#xa;(No slot found within&#xa;search window)" style="ellipse;whiteSpace=wrap;html=1;fillColor=#f8cecc;strokeColor=#b85450;fontStyle=1;fontSize=11" vertex="1" parent="1">
          <mxGeometry x="920" y="435" width="180" height="70" as="geometry" />
        </mxCell>
        
        <mxCell id="edge420_550" value="NO&#xa;(limit reached)" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontStyle=1;fontSize=10" edge="1" parent="1" source="420" target="550">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        
        <!-- Performance Note -->
        <mxCell id="perf_note" value="PERFORMANCE CHARACTERISTICS:&#xa;&#xa;Time Complexity: O(D × S × A)&#xa;  D = days searched (max 365)&#xa;  S = slots per day (48 for 30-min intervals)&#xa;  A = existing appointments (collision check)&#xa;&#xa;Space Complexity: O(1)&#xa;  Constant space, no additional data structures&#xa;&#xa;Maximum Iterations: 17,520&#xa;  (365 days × 48 slots/day)&#xa;&#xa;Early Termination: YES&#xa;  Returns immediately on first valid slot" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#e8f5e9;strokeColor=#4caf50;align=left;fontSize=9;fontStyle=0" vertex="1" parent="1">
          <mxGeometry x="920" y="560" width="280" height="220" as="geometry" />
        </mxCell>
        
      </root>
    </mxGraphModel>
  </diagram>
</mxfile>
